<!-- .slide: data-background="#ffffffff" -->

<section data-transition="none">

### w7.2 Which functions do VQMs express? <!-- .element: class="r-fit-text" -->

- [w7.2.1] Quantum models as Fourier series
- [w7.2.2] Main theorem and proof sketch
- [w7.2.3] Consequences and implications
- [w7.2.4] Example: Pauli-rotation encoding

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.1 - Introduction <!-- .element: class="r-fit-text" -->

<div style="text-align: justify;">

In the previous section, we saw that a simple single-qubit quantum model could be written as a sum of sine and cosine functions. This observation is not coincidental but reflects a fundamental property of quantum models with time-evolution encoding.

</div>

**Main result:** This trigonometric structure holds for ANY quantum model where features are encoded via gates $S_i(x_i) = e^{-ix_iG_i}$.

**Why this matters:**
- Opens the powerful tools of Fourier analysis to quantum machine learning
- The encoding strategy directly controls model expressivity
- Periodicity must be considered when preprocessing data
- Suggests applications where quantum models may excel

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.2 - Theorem 5.1 (1) <!-- .element: class="r-fit-text" -->

**Theorem 5.1 (Function class of quantum models)**

<div style="text-align: justify;">

Consider a quantum circuit that alternates feature-encoding and parametrised unitaries:

</div>

$$U(x, \theta) = W_{N+1}(\theta) \prod_{i=1}^{N} S_i(x_i)W_i(\theta_i)$$

<div style="text-align: justify;">

where feature-encoding gates have the form $S_i(x_i) = e^{-ix_iG_i}$ with $G_i$ a diagonal operator (we can always absorb non-diagonal parts into the parametrised unitaries).

Then $f_\theta$ can be written as a multi-dimensional Fourier-like series:

</div>

$$f_\theta(x) = \sum_{\omega_1 \in \Omega_1} \cdots \sum_{\omega_N \in \Omega_N} c_{\omega_1\ldots\omega_N}(\theta) e^{i\omega_1 x_1} \cdots e^{i\omega_N x_N}$$

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.2 - Theorem 5.1 (2) <!-- .element: class="r-fit-text" -->

**Frequency spectrum:**

<div style="text-align: justify;">

The frequencies accessible to the model are completely determined by the eigenvalues of the encoding generators:

</div>

$$\Omega_i = \{\lambda_{is} - \lambda_{it} \mid s, t \in \{1, \ldots, d\}\}$$

where $\lambda_{is}$ are the eigenvalues of generator $G_i$ and $d$ is the Hilbert space dimension.

**Important properties:**
- Always contains zero: $0 \in \Omega$ (when $s = t$)
- Symmetric: for each $\omega \in \Omega$, also $-\omega \in \Omega$ with $c_\omega(\theta) = c_{-\omega}^*(\theta)$
- This symmetry guarantees the output $f_\theta(x)$ is real-valued
- Can be rewritten using cosine and sine functions

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.2 - Proof sketch (1) <!-- .element: class="r-fit-text" -->

<div style="text-align: justify;">

The proof follows by writing the quantum circuit as matrix multiplication in the computational basis and carefully tracking how features combine through the gates.

</div>

**Step 1:** Write model as sum over all intermediate basis states:

$$f_\theta(x) = \sum_{j_1,\ldots,j_T=1}^{d} \left(W^*\right)_{1j_1}^{(1)} S_1(x_1)_{j_1j_2} \cdots W_{j_T1}$$

where $T = 4(N+1)$ and the sum runs over all matrix element indices.

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.2 - Proof sketch (2) <!-- .element: class="r-fit-text" -->

**Step 2:** Use that encoding gates are diagonal in the chosen basis:

$$\left(e^{-ix_iG_i}\right)_{lm} = e^{-ix_i\lambda_l^i}\delta_{lm}$$

<div style="text-align: justify;">

where $\delta_{lm}$ is the Kronecker delta (1 if $l=m$, 0 otherwise).

</div>

**Step 3:** Factors combine to produce phase terms:

$$e^{-ix_i\lambda_s^i}e^{ix_i\lambda_t^i} = e^{ix_i(\lambda_s^i - \lambda_t^i)}$$

**Step 4:** Collect all terms where the differences $\lambda_s^i - \lambda_t^i$ have the same value → defines frequency spectrum $\Omega_i$.

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.2 - Proof sketch (3) <!-- .element: class="r-fit-text" -->

**Step 5:** The coefficients $c_{\omega_1\ldots\omega_N}(\theta)$ are sums over products of matrix elements from the parametrised unitaries:

$$c_{\omega_1\ldots\omega_N} = \sum_{\substack{s_i,t_i \mid \\ \lambda_{is_i}^i - \lambda_{it_i}^i = \omega_i}} \sum_{k,k'} \left(W^*\right)_{1s_1}^{(1)} \cdots M_{kk'} \cdots W_{t_11}^*$$

<div style="text-align: justify;">

This shows that the parametrised unitaries determine the coefficients, while the encoding generators determine the frequencies. Both aspects are necessary for an expressive model.

</div>

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.3 - Consequences (1) <!-- .element: class="r-fit-text" -->

**Encoding determines frequencies, parameters determine coefficients:**

<div style="text-align: justify;">

The eigenvalues of the encoding generators $\{G_i\}$ are solely responsible for which frequencies appear in the Fourier expansion. The rest of the circuit design (parametrised unitaries and measurement) only affects the coefficients $c_{\omega}(\theta)$ that weight these frequencies.

</div>

**Both are needed for expressivity:**
- A rich frequency spectrum with many coefficients forced to zero → limited model
- Only a few frequencies with arbitrary coefficients → still limited model

<div style="text-align: justify;">

Therefore, designing expressive quantum models requires both thoughtful encoding strategies and sufficiently flexible variational circuits.

</div>

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.3 - Consequences (2) <!-- .element: class="r-fit-text" -->

**Integer frequencies give true Fourier series:**

<div style="text-align: justify;">

When all eigenvalue differences $\lambda_{is} - \lambda_{it}$ are integer-valued (as occurs with Pauli rotations), the model becomes a multi-dimensional Fourier series:

</div>

$$f_\theta(x) = \sum_{n_1\in\Omega_1} \cdots \sum_{n_N\in\Omega_N} c_{n_1\ldots n_N}(\theta) e^{in_1x_1} \cdots e^{in_Nx_N}$$

<div style="text-align: justify;">

This is particularly useful because functions of the form $\{e^{inx}\}$ with $n \in \mathbb{Z}$ form a complete orthonormal basis for functions (their inner product satisfies $\int e^{inx}e^{-imx}dx = \delta_{mn}$). This connection enables powerful techniques from Fourier analysis to study quantum model expressivity.

</div>

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.3 - Consequences (3) <!-- .element: class="r-fit-text" -->

**Repeating encoding gates enriches the spectrum:**

<div style="text-align: justify;">

If the same feature $z$ is encoded multiple times with the same generator $G$, say $x_i = x_j = z$ and $G_i = G_j = G$, then:

</div>

$$e^{i\omega_ix_i}e^{i\omega_jx_j} = e^{i(\omega_i+\omega_j)z}$$

<div style="text-align: justify;">

The frequency spectra combine additively to form a new, richer spectrum:

</div>

$$\tilde{\Omega} = \left\{(\lambda_{is} - \lambda_{it}) + (\lambda_{js} - \lambda_{jt}) \mid s,t \in \{1,\ldots,d\}\right\}$$

**Universal approximation:** By repeatedly encoding features with integer-valued spectra, we can in principle access any integer frequency. Combined with sufficient variational freedom, this makes quantum models universal function approximators.

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.3 - Consequences (4) <!-- .element: class="r-fit-text" -->

**Periodicity constraint:**

<div style="text-align: justify;">

Quantum models based on time-evolution encoding $e^{-ix_iG_i}$ are inherently periodic functions. The model cannot distinguish between input $x_i$ and $x_i + 2\pi$ (or more generally $x_i + 2\pi k$ for any integer $k$).

</div>

**Practical implication:** Data preprocessing must scale features to lie within the fundamental period, typically $[0, 2\pi)$ or $[-\pi, \pi)$.

**Fourier representation in parameters:**

<div style="text-align: justify;">

The same mathematical derivation applies to the parameters, giving:

</div>

$$f_\theta(x) = \sum_{\omega_1 \in \Omega_1} \cdots \sum_{\omega_K \in \Omega_K} c_{\omega_1\ldots\omega_K}(x) e^{i\omega_1\theta_1} \cdots e^{i\omega_K\theta_K}$$

This is useful for analyzing optimization landscapes and trainability.

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.4 - Example (1) <!-- .element: class="r-fit-text" -->

<div style="text-align: justify;">

Let us verify Theorem 5.1 using our standard single-qubit example. We will see how the abstract theorem correctly predicts the functional form we computed explicitly.

</div>

**Setup:**

Model: $f_\theta(x) = \langle 0|U^\dagger(x,\theta)\sigma_z U(x,\theta)|0\rangle$

Circuit: $U(x,\theta) = W_2(\theta_2)R_x(x)W_1(\theta_1)$

**Pauli-X generator:** The rotation $R_x(x) = e^{-i\frac{x}{2}\sigma_x}$ has generator $G = \frac{1}{2}\sigma_x$ with eigenvalues $\lambda_1 = +\frac{1}{2}$ and $\lambda_2 = -\frac{1}{2}$.

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.4 - Example (2) <!-- .element: class="r-fit-text" -->

**Computing the frequency spectrum:**

<div style="text-align: justify;">

According to Theorem 5.1, the spectrum consists of all differences between eigenvalues:

</div>

$$\Omega = \left\{\frac{1}{2} - \frac{1}{2}, \frac{1}{2} - \left(-\frac{1}{2}\right), -\frac{1}{2} - \frac{1}{2}, -\frac{1}{2} - \left(-\frac{1}{2}\right)\right\}$$

$$= \{0, 1, -1, 0\} = \{-1, 0, 1\}$$

**Predicted form from Theorem 5.1:**

$$f_\theta(x) = c_0(\theta) + c_1(\theta)e^{ix} + c_{-1}(\theta)e^{-ix}$$

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.4 - Example (3) <!-- .element: class="r-fit-text" -->

<div style="text-align: justify;">

Using the symmetry property $c_1 = c_{-1}^*$ (which guarantees real output) and Euler's formula $e^{ix} = \cos(x) + i\sin(x)$, we can rewrite this as:

</div>

$$f_\theta(x) = c_0 + a\cos(x) + b\sin(x)$$

where $a, b$ are real constants depending on $\theta$.

**Verification:** This exactly matches our explicit calculation from w7.1.3:

$$f_\theta(x) = \cos(\theta_2)\cos(x) - \sin(\theta_1)\sin(\theta_2)\sin(x)$$

<div style="text-align: justify;">

with $c_0 = 0$, $a = \cos(\theta_2)$, and $b = -\sin(\theta_1)\sin(\theta_2)$. The theorem correctly predicted the functional form!

</div>

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w7.2.4 - Example (4) <!-- .element: class="r-fit-text" -->

**Effect of repeating the encoding:**

<div style="text-align: justify;">

Consider now a circuit where the feature $x$ is encoded twice:

</div>

$$U(x,\theta) = W_3(\theta_3)R_x(x)W_2(\theta_2)R_x(x)W_1(\theta_1)$$

**New frequency spectrum:**

<div style="text-align: justify;">

The frequencies from both encodings add, giving:

</div>

$$\tilde{\Omega} = \{-2, -1, 0, 1, 2\}$$

**With $L$ repetitions:** The spectrum becomes $\Omega^{(L)} = \{-L, -L+1, \ldots, 0, \ldots, L-1, L\}$.

<div style="text-align: justify;">

This shows how data re-uploading (repeating encodings) systematically increases model expressivity by adding higher frequency components.

</div>

</section>