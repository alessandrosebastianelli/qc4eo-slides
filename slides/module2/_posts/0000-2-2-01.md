<!-- .slide: data-background="#ffffffff" -->

<section data-transition="none">

### w5.1 - Measuring qubits <!-- .element: class="r-fit-text" -->

- [w5.1.1] Projective measurement
- [w5.1.2] Measuring Qubits in the Computational Basis
- [w5.1.3] Expectation value

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.1 - Projective measurement (1) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        For a quantum mechanical system is a pure state $|\psi\rangle$, we consider an observable $\mathbb{M}$ with a discrete spectrum, i.e.
        $$\mathbb{M}=\sum_{k}\mu_kP_k$$
        where $P_k$ denotes the projector on the eignespace spanned by the $k$-th eigenvector. $\{\mu_k\}$ are the measurement results of a measurement associated with projectors $P_k$.
    </p>
    <p>
        According to the <i>Born rule</i>, the probability to obtain the measurement result $u_k$ is given by
        $$p(u_k)=tr\{P_k|\psi\rangle\langle\psi|\}=\langle\psi|P_k|\psi\rangle$$
    </p>
  </div>

</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.1 - Projective measurement (2) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        The state of the system after measuring $\mu_k$ is given by
        $$|\psi\rangle\longrightarrow\frac{P_k|\psi\rangle}{\sqrt{\langle\psi|P_k|\psi\rangle}}$$
        In general if the system is described by a density matrix $\rho$, the probability of measuring $\mu_k$ will be:
        $$p(u_k)=tr\{P_k\rho\}$$
        and the state of the system after measuring $\mu_k$ will be
        $$\frac{P_k\rho P_k}{tr\{P_k\rho\}}$$
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.1 - Projective measurement (3) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
       Consider now a more general case where a measurement is defined by a collection of operators $\{A_j\}$ that do not necessarily have to be projectors. 
       If the state of the system is described by the pure state $|\psi\rangle$, the probability that the result $a_j$ related to operator $A_j$ occurs is given by
       $$p(a_j)=\langle\psi|A_{j}^{\dagger}A_j|\psi\rangle$$
       and the state after measuring $a_j$ is 
       $$\frac{A_j|\psi\rangle}{\sqrt{\langle\psi|A_{j}^{\dagger}A_j|\psi\rangle}}$$
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.1 - Projective measurement (4) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
       The measurement operators satisfy the completeness relation $\sum_{j}A_{j}^{\dagger}A_j=\mathbb{1}$. If we define 
       $$E_j=A_{j}^{\dagger}A_j$$
       it follows $\sum_jE_j=\mathbb{1}$ and $p(a_j)=\langle\psi|E_j|\psi\rangle$. The operators $E_j$ are called Positive Operator-Valued Measure (POVM) elements and their complete set is known as Positive Operator-Valued Measurement. 
       This is the most general framework to describe typical quantum measurement. 
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.2 - Measuring Qubits in the Computational Basis (1) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        In most algorithms we only need computational basis measurement which measures whether the individual qubits are in state $|0\rangle$ or $|1\rangle$.
    </p>
    <br>
    <p>
        A lot of actial quantum computing platforms only implement this simplest kind of measurement, and implement more complicated observables by applying a circuit $U$ just before measuring.  
    </p>
    <br>
    <p>
        This pre-measurement circuit can be undestrood as a basis tranformation on the quantum state which effectively implements the more complicated observable.
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.2 - Measuring Qubits in the Computational Basis (2) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        A computational basis measurement of a generic (normalised) qubit state $|\psi\rangle=\alpha_0|0\rangle+\alpha_1|1\rangle$ is reperesented by the projectors on the two possible eigenspaces $P_0=|0\rangle\langle0|$ and $P_1=|1\rangle\langle1|$. The probability of obtaining the measurement outcome $0$ is then
        $$p(0)=tr(P_0|\psi\rangle\langle\psi|)=\langle\psi|P_0|\psi\rangle=|\alpha_0|^2$$
    </p>
    <p>
        Similarly, one finds that $p(1)=|\alpha_1|^2$. After the measurement, say of outcome $0$, the qubit is in the state
        $$|\psi\rangle\longleftarrow\frac{P_0|\psi\rangle}{\sqrt{\langle\psi|P_0|\psi\rangle}}=|0\rangle$$
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.2 - Measuring Qubits in the Computational Basis (3) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        The full observable corresponding to a computational basis measurement is the Pauli Z observable
        $$\sigma_z=|0\rangle\langle0|-|1\rangle\langle1|$$
        from which we can read off the eigenvalues:
    </p>
    <br>
    <p>
        <ul>
            <li> $+1 \longrightarrow$ corresponding to the observation $|0\rangle$</li>
            <li> $-1 \longrightarrow$ corresponding to the observation $|1\rangle$</li>
        </ul>
    </p>
    <br>
    <p>
        Separate computational basis measurements performed on multiple qubits can be understood as drawing a sample of a binary string of lenght $n$ (qubits) from a distribution defined by the quantum state. 
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.3 - Expectation Value (1) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        The expectation $\langle\sigma_z\rangle$ of a single-qubit measurement in the computational basis is a value in the range $[-1, 1].$
    </p>
    <br>
    <p>
        In practice the expectation iis is estimated by rerunning an algorithm $s$ times to sample $S$ bits in $\{-1, 1\}$, where $S$ is also known as the number of <i>shots</i>. The estimate is then computed as the average of the bits.
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.3 - Expectation Value (2) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        The number of samples $S$ required to estimate $\langle\sigma_z\rangle$ with error $\epsilon$ can be derived by estimating the probability $p$ when sampling from a <i>Bernoulli</i> distribution *.
    </p>
    <br>
    <p>
        The error gives us a <i>confidence interval</i> $[p-\epsilon, p+\epsilon]$, that is defined for a specific <i>confidence level</i> e.g. $99\%$
    </p>
    <br>
    <p>
        Confidence level $\rightarrow$ "If we have different sets $\mathbb{S}$ of $S$ samples and compute estimators and confidence intevals for each of them, the confidence level is the proportion of sample sets for which the true value $p$ lies within the confidence interval." In statistics this is called $z$-value.
    </p>
    <p>
    <small>
        *) Bernoulli sampling is equivalent to a biased coin toss experiment. We flip a coin $S$ times and want to estimate the bias $p$, i.e. with what probability the coin produces <i>heads</i>.
    </small>
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.3 - Expectation Value (3) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        There are different wasy to estimate the error of a Bernoulli trial. The most simple one is the <i>Wald interval</i> which is suited for cases of large $S$ and $p\approx 0.5$, corresponding to $\langle\sigma_z\rangle=0$. The error $\epsilon$ can be calculated as
        $$\epsilon=z\sqrt{\frac{\hat{p}(1-\hat{p})}{S}}$$
        where $\hat{p}$ is the share of the samples being in state $1$, which is a simple estimator for the probability. This is maximised for $\hat{p}=0.5$, so that we can assume the overall error of our esitmation $\epsilon$ to be at most
        $$\epsilon\leq\frac{z}{2\sqrt{S}}$$
        with a confidence level of $z$. 
    </p>
  </div>
</section>

<!-- ============================================================================ -->

<section data-transition="none">

### w5.1.3 - Expectation Value (4) <!-- .element: class="r-fit-text" -->
  <div style="text-align: justify;">
    <p>
        For a given $\epsilon$ and $z$, we need $\mathcal{O}(\epsilon^{-2})$ samples $S$ from the qubit measurement.
    </p>
    <br>
    <p>
        For instance, if we want to have an error of at most $\epsilon=0.1$ and a confidence level of $99\%$, we need about $167$ samples.
    </p>
    <p>
        While for an error of $\epsilon=0.01$ with a confidence level of $99\%$, we need at most $17.000$ samples.
    </p>
  </div>
</section>
